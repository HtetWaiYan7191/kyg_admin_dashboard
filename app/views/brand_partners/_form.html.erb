<%= render 'shared/back_button' %>
<%= render 'layouts/auth_layout' do %>

  <% if @brand_partner.persisted? %>
    <h2 class="form-title">Update Brand Partner</h2>
  <% else %>
    <h2 class="form-title">Create Brand Partner</h2>
  <% end %>
  <div class="form-container">
      <%= form_with(model: brand_partner, data: { controller: 'nested-form', nested_form_wrapper_selector_value: '.nested-form-wrapper' } ) do |form| %>
      <div class="mb-4">
        <%= render partial: 'shared/label_with_errors', locals: {form: form, field_name: :name, record: brand_partner} %>
        <%= form.text_field :name, class: 'form-control' %>
      </div>

      <div class="mb-4">
        <%= render partial: 'shared/label_with_errors', locals: {form: form, field_name: :brand_category, record: brand_partner} %>
        <%= form.select :brand_category_id, BrandCategory.order(:name).map { |brand_category| [brand_category.name, brand_category.id] }, {prompt: "Select Category"}, {class: 'form-select'} %>
      </div>

      <div class="mb-4">
        <%= render partial: 'shared/label_with_errors', locals: {form: form, field_name: :image, record: brand_partner} %>
        <% if brand_partner.image.attached? && brand_partner.image.persisted? %>
          <%= form.hidden_field :image, value: brand_partner.image.signed_id %>
        <% end %>

        <%= form.file_field :image, class: 'form-control' %>
      </div>

      <div class="mb-4" >
        <%= render partial: 'shared/label_with_errors', locals: {form: form, field_name: :benefits, record: brand_partner} %>
          <template data-nested-form-target="template">
            <%= form.fields_for :benefits, Benefit.new, child_index: 'NEW_RECORD' do |benefit_form| %>
              <%= render "benefit_form", f: benefit_form %>
            <% end %>
          </template>

            <%= form.fields_for :benefits do |benefit_form| %>
              <%= render 'benefit_form', f: benefit_form %>
            <% end %>

        <div data-nested-form-target="target"></div>  

        <div class="d-flex align-items-center justify-content-end mt-2">
            <button type="button" data-action="nested-form#add">
              <i class="bi bi-plus-circle" style="font-size: 20px;"></i>
            </button>
        </div>

      </div>

      <div class="mt-3">
          <% unless @brand_partner.persisted?%>
              <%= form.submit "Create", class: 'btn btn-primary w-100 text-center fw-semibold ' %>
          <% else %>
              <%= form.submit "Update", class: 'btn btn-primary w-100 text-center fw-semibold ' %>
          <% end %>      
      </div>
    <% end %>
  </div>
<% end %>

